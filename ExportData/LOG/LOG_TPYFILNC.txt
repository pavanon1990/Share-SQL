INSERT INTO MIG_NC_LOG --MIG_NC_TPYFILNC
select SYS_GUID(),'MIG_NC_TPYFILNC' as FIL_ENAME ,gps.GP_CORE_SYSTEM,gps.ModuleCode,gps.GP_POLNO,gps.GP_CUSTREFNO
       ,'Can not mapping data from table data_conso.cclient_pol' as MESSAGE
       ,'GPS'
from (
select '10000'||substr(trim(inf.pywref),2,length(inf.pywref)) as polno,inf.pywref,lnc.wkrefn from mig_nc_interface inf
      left join 
           (
              select t.wkrefn,t.wkorgn from MIG_NC_TPYFILNC t
              group by t.wkrefn,t.wkorgn
           )lnc on trim(inf.pywref) = trim(lnc.wkrefn)
where lnc.wkrefn is null
) mtb 
inner join data_gps gps on mtb.polno = gps.GP_POLNO

insert into MIG_NC_LOG  -- MIG_NC_TPYFILNC PLNCDE
select SYS_GUID(),'MIG_NC_TPYFILNC' as FIL_ENAME,t.Core_System,t.Module_Type,gps.gp_polno,gps.gp_custrefno
,CASE WHEN Module_Type = 'TCLM' THEN 'Data not found PLAN CODE in DATA_CONSO.CLAIM_TRANSACTION' ELSE 'Data not found PLAN CODE in POLMSTPF' END 
,'GPS'
  from MIG_NC_TPYFILNC t
inner join gps_payment gps on t.wkorgn = gps.gp_custrefno
where t.wkplnc is null
